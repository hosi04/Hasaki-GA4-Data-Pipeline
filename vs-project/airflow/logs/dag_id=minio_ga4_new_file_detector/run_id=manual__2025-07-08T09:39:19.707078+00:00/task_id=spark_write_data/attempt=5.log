[2025-07-08T10:05:51.728+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-07-08T10:05:51.747+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: minio_ga4_new_file_detector.spark_write_data manual__2025-07-08T09:39:19.707078+00:00 [queued]>
[2025-07-08T10:05:51.751+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: minio_ga4_new_file_detector.spark_write_data manual__2025-07-08T09:39:19.707078+00:00 [queued]>
[2025-07-08T10:05:51.751+0000] {taskinstance.py:2303} INFO - Starting attempt 5 of 6
[2025-07-08T10:05:51.760+0000] {taskinstance.py:2327} INFO - Executing <Task(SparkSubmitOperator): spark_write_data> on 2025-07-08 09:39:19.707078+00:00
[2025-07-08T10:05:51.766+0000] {standard_task_runner.py:63} INFO - Started process 10173 to run task
[2025-07-08T10:05:51.769+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'minio_ga4_new_file_detector', 'spark_write_data', 'manual__2025-07-08T09:39:19.707078+00:00', '--job-id', '198', '--raw', '--subdir', 'DAGS_FOLDER/dag_automatic.py', '--cfg-path', '/tmp/tmpvye_f5d5']
[2025-07-08T10:05:51.771+0000] {standard_task_runner.py:91} INFO - Job 198: Subtask spark_write_data
[2025-07-08T10:05:51.781+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.11/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-07-08T10:05:51.802+0000] {task_command.py:426} INFO - Running <TaskInstance: minio_ga4_new_file_detector.spark_write_data manual__2025-07-08T09:39:19.707078+00:00 [running]> on host 1a66de7e9daf
[2025-07-08T10:05:51.853+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='minio_ga4_new_file_detector' AIRFLOW_CTX_TASK_ID='spark_write_data' AIRFLOW_CTX_EXECUTION_DATE='2025-07-08T09:39:19.707078+00:00' AIRFLOW_CTX_TRY_NUMBER='5' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-07-08T09:39:19.707078+00:00'
[2025-07-08T10:05:51.854+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-07-08T10:05:51.864+0000] {base.py:84} INFO - Using connection ID 'spark-master' for task execution.
[2025-07-08T10:05:51.866+0000] {spark_submit.py:473} INFO - Spark-Submit cmd: spark-submit --master spark://spark-master:7077:7077 --packages com.clickhouse:clickhouse-jdbc:0.6.4,org.apache.httpcomponents.client5:httpclient5:5.3.1,org.apache.hadoop:hadoop-aws:3.3.5,com.amazonaws:aws-java-sdk-bundle:1.11.1026 --name arrow-spark --deploy-mode client /opt/***/spark_project/src/spark/spark_main_minio_automatic.py ["ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/0.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/1.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/2.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/3.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/4.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/5.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/6.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/7.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/8.parquet", "ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/9.parquet"]
[2025-07-08T10:05:52.081+0000] {spark_submit.py:634} INFO - WARNING: Using incubator modules: jdk.incubator.vector
[2025-07-08T10:05:53.478+0000] {spark_submit.py:634} INFO - :: loading settings :: url = jar:file:/home/***/.local/lib/python3.11/site-packages/pyspark/jars/ivy-2.5.3.jar!/org/apache/ivy/core/settings/ivysettings.xml
[2025-07-08T10:05:53.555+0000] {spark_submit.py:634} INFO - Ivy Default Cache set to: /home/***/.ivy2.5.2/cache
[2025-07-08T10:05:53.556+0000] {spark_submit.py:634} INFO - The jars for the packages stored in: /home/***/.ivy2.5.2/jars
[2025-07-08T10:05:53.558+0000] {spark_submit.py:634} INFO - com.clickhouse#clickhouse-jdbc added as a dependency
[2025-07-08T10:05:53.558+0000] {spark_submit.py:634} INFO - org.apache.httpcomponents.client5#httpclient5 added as a dependency
[2025-07-08T10:05:53.558+0000] {spark_submit.py:634} INFO - org.apache.hadoop#hadoop-aws added as a dependency
[2025-07-08T10:05:53.558+0000] {spark_submit.py:634} INFO - com.amazonaws#aws-java-sdk-bundle added as a dependency
[2025-07-08T10:05:53.558+0000] {spark_submit.py:634} INFO - :: resolving dependencies :: org.apache.spark#spark-submit-parent-b29e0c66-cdba-41ff-aba2-cfd906942759;1.0
[2025-07-08T10:05:53.559+0000] {spark_submit.py:634} INFO - confs: [default]
[2025-07-08T10:05:53.731+0000] {spark_submit.py:634} INFO - found com.clickhouse#clickhouse-jdbc;0.6.4 in central
[2025-07-08T10:05:53.749+0000] {spark_submit.py:634} INFO - found org.apache.httpcomponents.client5#httpclient5;5.3.1 in central
[2025-07-08T10:05:53.830+0000] {spark_submit.py:634} INFO - found org.apache.httpcomponents.core5#httpcore5;5.2.4 in central
[2025-07-08T10:05:53.843+0000] {spark_submit.py:634} INFO - found org.apache.httpcomponents.core5#httpcore5-h2;5.2.4 in central
[2025-07-08T10:05:53.854+0000] {spark_submit.py:634} INFO - found org.slf4j#slf4j-api;1.7.36 in central
[2025-07-08T10:05:53.941+0000] {spark_submit.py:634} INFO - found org.apache.hadoop#hadoop-aws;3.3.5 in central
[2025-07-08T10:05:53.950+0000] {spark_submit.py:634} INFO - found com.amazonaws#aws-java-sdk-bundle;1.12.316 in central
[2025-07-08T10:05:54.026+0000] {spark_submit.py:634} INFO - found org.wildfly.openssl#wildfly-openssl;1.1.3.Final in central
[2025-07-08T10:05:54.041+0000] {spark_submit.py:634} INFO - :: resolution report :: resolve 474ms :: artifacts dl 9ms
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - :: modules in use:
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - com.amazonaws#aws-java-sdk-bundle;1.12.316 from central in [default]
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - com.clickhouse#clickhouse-jdbc;0.6.4 from central in [default]
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - org.apache.hadoop#hadoop-aws;3.3.5 from central in [default]
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - org.apache.httpcomponents.client5#httpclient5;5.3.1 from central in [default]
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - org.apache.httpcomponents.core5#httpcore5;5.2.4 from central in [default]
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - org.apache.httpcomponents.core5#httpcore5-h2;5.2.4 from central in [default]
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - org.slf4j#slf4j-api;1.7.36 from central in [default]
[2025-07-08T10:05:54.042+0000] {spark_submit.py:634} INFO - org.wildfly.openssl#wildfly-openssl;1.1.3.Final from central in [default]
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - :: evicted modules:
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - com.amazonaws#aws-java-sdk-bundle;1.11.1026 by [com.amazonaws#aws-java-sdk-bundle;1.12.316] in [default]
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - ---------------------------------------------------------------------
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - |                  |            modules            ||   artifacts   |
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - |       conf       | number| search|dwnlded|evicted|| number|dwnlded|
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - ---------------------------------------------------------------------
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - |      default     |   9   |   0   |   0   |   1   ||   8   |   0   |
[2025-07-08T10:05:54.043+0000] {spark_submit.py:634} INFO - ---------------------------------------------------------------------
[2025-07-08T10:05:54.045+0000] {spark_submit.py:634} INFO - :: retrieving :: org.apache.spark#spark-submit-parent-b29e0c66-cdba-41ff-aba2-cfd906942759
[2025-07-08T10:05:54.045+0000] {spark_submit.py:634} INFO - confs: [default]
[2025-07-08T10:05:54.049+0000] {spark_submit.py:634} INFO - 0 artifacts copied, 8 already retrieved (0kB/4ms)
[2025-07-08T10:05:54.358+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:54 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-07-08T10:05:55.854+0000] {spark_submit.py:634} INFO - Using Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties
[2025-07-08T10:05:55.858+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO SparkContext: Running Spark version 4.0.0
[2025-07-08T10:05:55.859+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO SparkContext: OS info Linux, 6.8.0-60-generic, amd64
[2025-07-08T10:05:55.859+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO SparkContext: Java version 17.0.15
[2025-07-08T10:05:55.935+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO ResourceUtils: ==============================================================
[2025-07-08T10:05:55.936+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO ResourceUtils: No custom resources configured for spark.driver.
[2025-07-08T10:05:55.937+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO ResourceUtils: ==============================================================
[2025-07-08T10:05:55.938+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO SparkContext: Submitted application: thanhdz
[2025-07-08T10:05:55.956+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
[2025-07-08T10:05:55.959+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
[2025-07-08T10:05:55.960+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:55 INFO ResourceProfileManager: Added ResourceProfile id: 0
[2025-07-08T10:05:56.048+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing view acls to: ***
[2025-07-08T10:05:56.048+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing modify acls to: ***
[2025-07-08T10:05:56.048+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing view acls groups to: ***
[2025-07-08T10:05:56.049+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing modify acls groups to: ***
[2025-07-08T10:05:56.050+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: *** groups with view permissions: EMPTY; users with modify permissions: ***; groups with modify permissions: EMPTY; RPC SSL disabled
[2025-07-08T10:05:56.268+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Successfully started service 'sparkDriver' on port 43261.
[2025-07-08T10:05:56.323+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkEnv: Registering MapOutputTracker
[2025-07-08T10:05:56.332+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkEnv: Registering BlockManagerMaster
[2025-07-08T10:05:56.340+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[2025-07-08T10:05:56.340+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
[2025-07-08T10:05:56.342+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
[2025-07-08T10:05:56.353+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-7125b0a4-9b5c-4351-b87e-ffdb8917564f
[2025-07-08T10:05:56.364+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkEnv: Registering OutputCommitCoordinator
[2025-07-08T10:05:56.526+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
[2025-07-08T10:05:56.631+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Successfully started service 'SparkUI' on port 4040.
[2025-07-08T10:05:56.669+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/com.clickhouse_clickhouse-jdbc-0.6.4.jar at spark://1a66de7e9daf:43261/jars/com.clickhouse_clickhouse-jdbc-0.6.4.jar with timestamp 1751969155850
[2025-07-08T10:05:56.669+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/org.apache.httpcomponents.client5_httpclient5-5.3.1.jar at spark://1a66de7e9daf:43261/jars/org.apache.httpcomponents.client5_httpclient5-5.3.1.jar with timestamp 1751969155850
[2025-07-08T10:05:56.669+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/org.apache.hadoop_hadoop-aws-3.3.5.jar at spark://1a66de7e9daf:43261/jars/org.apache.hadoop_hadoop-aws-3.3.5.jar with timestamp 1751969155850
[2025-07-08T10:05:56.669+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/org.apache.httpcomponents.core5_httpcore5-5.2.4.jar at spark://1a66de7e9daf:43261/jars/org.apache.httpcomponents.core5_httpcore5-5.2.4.jar with timestamp 1751969155850
[2025-07-08T10:05:56.670+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/org.apache.httpcomponents.core5_httpcore5-h2-5.2.4.jar at spark://1a66de7e9daf:43261/jars/org.apache.httpcomponents.core5_httpcore5-h2-5.2.4.jar with timestamp 1751969155850
[2025-07-08T10:05:56.670+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/org.slf4j_slf4j-api-1.7.36.jar at spark://1a66de7e9daf:43261/jars/org.slf4j_slf4j-api-1.7.36.jar with timestamp 1751969155850
[2025-07-08T10:05:56.670+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/com.amazonaws_aws-java-sdk-bundle-1.12.316.jar at spark://1a66de7e9daf:43261/jars/com.amazonaws_aws-java-sdk-bundle-1.12.316.jar with timestamp 1751969155850
[2025-07-08T10:05:56.670+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added JAR file:///home/***/.ivy2.5.2/jars/org.wildfly.openssl_wildfly-openssl-1.1.3.Final.jar at spark://1a66de7e9daf:43261/jars/org.wildfly.openssl_wildfly-openssl-1.1.3.Final.jar with timestamp 1751969155850
[2025-07-08T10:05:56.672+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/com.clickhouse_clickhouse-jdbc-0.6.4.jar at spark://1a66de7e9daf:43261/files/com.clickhouse_clickhouse-jdbc-0.6.4.jar with timestamp 1751969155850
[2025-07-08T10:05:56.673+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/com.clickhouse_clickhouse-jdbc-0.6.4.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/com.clickhouse_clickhouse-jdbc-0.6.4.jar
[2025-07-08T10:05:56.731+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/org.apache.httpcomponents.client5_httpclient5-5.3.1.jar at spark://1a66de7e9daf:43261/files/org.apache.httpcomponents.client5_httpclient5-5.3.1.jar with timestamp 1751969155850
[2025-07-08T10:05:56.731+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/org.apache.httpcomponents.client5_httpclient5-5.3.1.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/org.apache.httpcomponents.client5_httpclient5-5.3.1.jar
[2025-07-08T10:05:56.737+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/org.apache.hadoop_hadoop-aws-3.3.5.jar at spark://1a66de7e9daf:43261/files/org.apache.hadoop_hadoop-aws-3.3.5.jar with timestamp 1751969155850
[2025-07-08T10:05:56.737+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/org.apache.hadoop_hadoop-aws-3.3.5.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/org.apache.hadoop_hadoop-aws-3.3.5.jar
[2025-07-08T10:05:56.742+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/org.apache.httpcomponents.core5_httpcore5-5.2.4.jar at spark://1a66de7e9daf:43261/files/org.apache.httpcomponents.core5_httpcore5-5.2.4.jar with timestamp 1751969155850
[2025-07-08T10:05:56.743+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/org.apache.httpcomponents.core5_httpcore5-5.2.4.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/org.apache.httpcomponents.core5_httpcore5-5.2.4.jar
[2025-07-08T10:05:56.748+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/org.apache.httpcomponents.core5_httpcore5-h2-5.2.4.jar at spark://1a66de7e9daf:43261/files/org.apache.httpcomponents.core5_httpcore5-h2-5.2.4.jar with timestamp 1751969155850
[2025-07-08T10:05:56.749+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/org.apache.httpcomponents.core5_httpcore5-h2-5.2.4.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/org.apache.httpcomponents.core5_httpcore5-h2-5.2.4.jar
[2025-07-08T10:05:56.752+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/org.slf4j_slf4j-api-1.7.36.jar at spark://1a66de7e9daf:43261/files/org.slf4j_slf4j-api-1.7.36.jar with timestamp 1751969155850
[2025-07-08T10:05:56.752+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/org.slf4j_slf4j-api-1.7.36.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/org.slf4j_slf4j-api-1.7.36.jar
[2025-07-08T10:05:56.755+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/com.amazonaws_aws-java-sdk-bundle-1.12.316.jar at spark://1a66de7e9daf:43261/files/com.amazonaws_aws-java-sdk-bundle-1.12.316.jar with timestamp 1751969155850
[2025-07-08T10:05:56.755+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/com.amazonaws_aws-java-sdk-bundle-1.12.316.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/com.amazonaws_aws-java-sdk-bundle-1.12.316.jar
[2025-07-08T10:05:56.910+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SparkContext: Added file file:///home/***/.ivy2.5.2/jars/org.wildfly.openssl_wildfly-openssl-1.1.3.Final.jar at spark://1a66de7e9daf:43261/files/org.wildfly.openssl_wildfly-openssl-1.1.3.Final.jar with timestamp 1751969155850
[2025-07-08T10:05:56.911+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO Utils: Copying /home/***/.ivy2.5.2/jars/org.wildfly.openssl_wildfly-openssl-1.1.3.Final.jar to /tmp/spark-7ba4f45a-61c2-44cd-bdc8-62afc2390177/userFiles-8e43d63e-c038-4d32-9a2d-513fba0adc44/org.wildfly.openssl_wildfly-openssl-1.1.3.Final.jar
[2025-07-08T10:05:56.936+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing view acls to: ***
[2025-07-08T10:05:56.937+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing modify acls to: ***
[2025-07-08T10:05:56.937+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing view acls groups to: ***
[2025-07-08T10:05:56.937+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: Changing modify acls groups to: ***
[2025-07-08T10:05:56.937+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:56 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: *** groups with view permissions: EMPTY; users with modify permissions: ***; groups with modify permissions: EMPTY; RPC SSL disabled
[2025-07-08T10:05:57.147+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://spark-master:7077...
[2025-07-08T10:05:57.174+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO TransportClientFactory: Successfully created connection to spark-master/172.20.0.6:7077 after 13 ms (0 ms spent in bootstraps)
[2025-07-08T10:05:57.259+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20250708100557-0003
[2025-07-08T10:05:57.261+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20250708100557-0003/0 on worker-20250708063549-172.20.0.7-46463 (172.20.0.7:46463) with 2 core(s)
[2025-07-08T10:05:57.262+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO StandaloneSchedulerBackend: Granted executor ID app-20250708100557-0003/0 on hostPort 172.20.0.7:46463 with 2 core(s), 1024.0 MiB RAM
[2025-07-08T10:05:57.266+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 33173.
[2025-07-08T10:05:57.266+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO NettyBlockTransferService: Server created on 1a66de7e9daf:33173
[2025-07-08T10:05:57.267+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[2025-07-08T10:05:57.327+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 1a66de7e9daf, 33173, None)
[2025-07-08T10:05:57.328+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20250708100557-0003/0 is now RUNNING
[2025-07-08T10:05:57.330+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO BlockManagerMasterEndpoint: Registering block manager 1a66de7e9daf:33173 with 413.9 MiB RAM, BlockManagerId(driver, 1a66de7e9daf, 33173, None)
[2025-07-08T10:05:57.331+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 1a66de7e9daf, 33173, None)
[2025-07-08T10:05:57.332+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 1a66de7e9daf, 33173, None)
[2025-07-08T10:05:57.539+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:57 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
[2025-07-08T10:05:58.632+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:58 INFO StandaloneSchedulerBackend$StandaloneDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.20.0.7:47714) with ID 0, ResourceProfileId 0
[2025-07-08T10:05:58.727+0000] {spark_submit.py:634} INFO - 25/07/08 10:05:58 INFO BlockManagerMasterEndpoint: Registering block manager 172.20.0.7:35783 with 434.4 MiB RAM, BlockManagerId(0, 172.20.0.7, 35783, None)
[2025-07-08T10:06:00.359+0000] {spark_submit.py:634} INFO - Đang đọc dữ liệu từ các đường dẫn MinIO sau: ['s3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/0.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/1.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/2.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/3.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/4.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/5.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/6.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/7.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/8.parquet', 's3a://hasaki-datalake/ga4-data/hasakiwork/analytics_253437596/events/2025/7/8/9.parquet']
[2025-07-08T10:06:01.283+0000] {spark_submit.py:634} INFO - 25/07/08 10:06:01 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
[2025-07-08T10:06:06.661+0000] {spark_submit.py:634} INFO - 25/07/08 10:06:06 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[2025-07-08T10:06:58.681+0000] {spark_submit.py:634} INFO - 25/07/08 10:06:58 WARN TaskSetManager: Lost task 1.0 in stage 3.0 (TID 5) (172.20.0.7 executor 0): org.apache.spark.SparkRuntimeException: [DUPLICATED_MAP_KEY] Duplicate map key currency was found, please check the input data.
[2025-07-08T10:06:58.681+0000] {spark_submit.py:634} INFO - If you want to remove the duplicated keys, you can set "spark.sql.mapKeyDedupPolicy" to "LAST_WIN" so that the key inserted at last takes precedence. SQLSTATE: 23505
[2025-07-08T10:06:58.681+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.errors.QueryExecutionErrors$.duplicateMapKeyFoundError(QueryExecutionErrors.scala:1197)
[2025-07-08T10:06:58.681+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.util.ArrayBasedMapBuilder.put(ArrayBasedMapBuilder.scala:88)
[2025-07-08T10:06:58.682+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.util.ArrayBasedMapBuilder.put(ArrayBasedMapBuilder.scala:103)
[2025-07-08T10:06:58.682+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.writeFields_0_1$(Unknown Source)
[2025-07-08T10:06:58.682+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.apply(Unknown Source)
[2025-07-08T10:06:58.682+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.AggregationIterator.$anonfun$generateResultProjection$5(AggregationIterator.scala:263)
[2025-07-08T10:06:58.682+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.ObjectAggregationIterator.next(ObjectAggregationIterator.scala:100)
[2025-07-08T10:06:58.682+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.ObjectAggregationIterator.next(ObjectAggregationIterator.scala:35)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at scala.collection.Iterator$$anon$9.next(Iterator.scala:584)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at scala.collection.Iterator$$anon$9.next(Iterator.scala:584)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.savePartition(JdbcUtils.scala:823)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$saveTable$1(JdbcUtils.scala:995)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$saveTable$1$adapted(JdbcUtils.scala:994)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at org.apache.spark.rdd.RDD.$anonfun$foreachPartition$2(RDD.scala:1047)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at org.apache.spark.rdd.RDD.$anonfun$foreachPartition$2$adapted(RDD.scala:1047)
[2025-07-08T10:06:58.683+0000] {spark_submit.py:634} INFO - at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2524)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:171)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.scheduler.Task.run(Task.scala:147)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$5(Executor.scala:647)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:80)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:77)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:99)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:650)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
[2025-07-08T10:06:58.684+0000] {spark_submit.py:634} INFO - at java.base/java.lang.Thread.run(Unknown Source)
[2025-07-08T10:06:58.685+0000] {spark_submit.py:634} INFO - 
[2025-07-08T10:06:58.718+0000] {spark_submit.py:634} INFO - 25/07/08 10:06:58 WARN TaskSetManager: Lost task 0.0 in stage 3.0 (TID 4) (172.20.0.7 executor 0): org.apache.spark.SparkRuntimeException: [DUPLICATED_MAP_KEY] Duplicate map key batch_ordering_id was found, please check the input data.
[2025-07-08T10:06:58.719+0000] {spark_submit.py:634} INFO - If you want to remove the duplicated keys, you can set "spark.sql.mapKeyDedupPolicy" to "LAST_WIN" so that the key inserted at last takes precedence. SQLSTATE: 23505
[2025-07-08T10:06:58.719+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.errors.QueryExecutionErrors$.duplicateMapKeyFoundError(QueryExecutionErrors.scala:1197)
[2025-07-08T10:06:58.719+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.util.ArrayBasedMapBuilder.put(ArrayBasedMapBuilder.scala:88)
[2025-07-08T10:06:58.719+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.util.ArrayBasedMapBuilder.put(ArrayBasedMapBuilder.scala:103)
[2025-07-08T10:06:58.719+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.writeFields_0_1$(Unknown Source)
[2025-07-08T10:06:58.719+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.apply(Unknown Source)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.AggregationIterator.$anonfun$generateResultProjection$5(AggregationIterator.scala:263)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.ObjectAggregationIterator.next(ObjectAggregationIterator.scala:100)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.ObjectAggregationIterator.next(ObjectAggregationIterator.scala:35)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at scala.collection.Iterator$$anon$9.next(Iterator.scala:584)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at scala.collection.Iterator$$anon$9.next(Iterator.scala:584)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.savePartition(JdbcUtils.scala:823)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$saveTable$1(JdbcUtils.scala:995)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$saveTable$1$adapted(JdbcUtils.scala:994)
[2025-07-08T10:06:58.720+0000] {spark_submit.py:634} INFO - at org.apache.spark.rdd.RDD.$anonfun$foreachPartition$2(RDD.scala:1047)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.rdd.RDD.$anonfun$foreachPartition$2$adapted(RDD.scala:1047)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2524)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:171)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.scheduler.Task.run(Task.scala:147)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$5(Executor.scala:647)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:80)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:77)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:99)
[2025-07-08T10:06:58.721+0000] {spark_submit.py:634} INFO - at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:650)
[2025-07-08T10:06:58.722+0000] {spark_submit.py:634} INFO - at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
[2025-07-08T10:06:58.722+0000] {spark_submit.py:634} INFO - at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
[2025-07-08T10:06:58.722+0000] {spark_submit.py:634} INFO - at java.base/java.lang.Thread.run(Unknown Source)
[2025-07-08T10:06:58.722+0000] {spark_submit.py:634} INFO - 
[2025-07-08T10:06:59.301+0000] {spark_submit.py:634} INFO - 25/07/08 10:06:59 WARN TaskSetManager: Lost task 2.0 in stage 3.0 (TID 6) (172.20.0.7 executor 0): org.apache.spark.SparkRuntimeException: [DUPLICATED_MAP_KEY] Duplicate map key page_location was found, please check the input data.
[2025-07-08T10:06:59.301+0000] {spark_submit.py:634} INFO - If you want to remove the duplicated keys, you can set "spark.sql.mapKeyDedupPolicy" to "LAST_WIN" so that the key inserted at last takes precedence. SQLSTATE: 23505
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.errors.QueryExecutionErrors$.duplicateMapKeyFoundError(QueryExecutionErrors.scala:1197)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.util.ArrayBasedMapBuilder.put(ArrayBasedMapBuilder.scala:88)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.util.ArrayBasedMapBuilder.put(ArrayBasedMapBuilder.scala:103)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.writeFields_0_1$(Unknown Source)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.apply(Unknown Source)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.AggregationIterator.$anonfun$generateResultProjection$5(AggregationIterator.scala:263)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.ObjectAggregationIterator.next(ObjectAggregationIterator.scala:100)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.aggregate.ObjectAggregationIterator.next(ObjectAggregationIterator.scala:35)
[2025-07-08T10:06:59.302+0000] {spark_submit.py:634} INFO - at scala.collection.Iterator$$anon$9.next(Iterator.scala:584)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at scala.collection.Iterator$$anon$9.next(Iterator.scala:584)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.savePartition(JdbcUtils.scala:823)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$saveTable$1(JdbcUtils.scala:995)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$saveTable$1$adapted(JdbcUtils.scala:994)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.rdd.RDD.$anonfun$foreachPartition$2(RDD.scala:1047)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.rdd.RDD.$anonfun$foreachPartition$2$adapted(RDD.scala:1047)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2524)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:171)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.scheduler.Task.run(Task.scala:147)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$5(Executor.scala:647)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:80)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:77)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:99)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:650)
[2025-07-08T10:06:59.303+0000] {spark_submit.py:634} INFO - at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
[2025-07-08T10:06:59.304+0000] {spark_submit.py:634} INFO - at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
[2025-07-08T10:06:59.304+0000] {spark_submit.py:634} INFO - at java.base/java.lang.Thread.run(Unknown Source)
[2025-07-08T10:06:59.304+0000] {spark_submit.py:634} INFO - 
[2025-07-08T10:07:01.462+0000] {spark_submit.py:634} INFO - 25/07/08 10:07:01 ERROR TaskSetManager: Task 1 in stage 3.0 failed 4 times; aborting job
[2025-07-08T10:07:01.488+0000] {spark_submit.py:634} INFO - 25/07/08 10:07:01 WARN TaskSetManager: Lost task 2.3 in stage 3.0 (TID 14) (172.20.0.7 executor 0): TaskKilled (Stage cancelled: [DUPLICATED_MAP_KEY] Duplicate map key currency was found, please check the input data.
[2025-07-08T10:07:01.488+0000] {spark_submit.py:634} INFO - If you want to remove the duplicated keys, you can set "spark.sql.mapKeyDedupPolicy" to "LAST_WIN" so that the key inserted at last takes precedence. SQLSTATE: 23505)
[2025-07-08T10:07:01.535+0000] {spark_submit.py:634} INFO - Lỗi khi ghi vào ClickHouse: [DUPLICATED_MAP_KEY] Duplicate map key currency was found, please check the input data.
[2025-07-08T10:07:01.535+0000] {spark_submit.py:634} INFO - If you want to remove the duplicated keys, you can set "spark.sql.mapKeyDedupPolicy" to "LAST_WIN" so that the key inserted at last takes precedence. SQLSTATE: 23505
[2025-07-08T10:07:01.680+0000] {spark_submit.py:634} INFO - -------------Stop SparkSession-------------
[2025-07-08T10:07:01.850+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-07-08T10:07:01.859+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=minio_ga4_new_file_detector, task_id=spark_write_data, execution_date=20250708T093919, start_date=20250708T100551, end_date=20250708T100701
[2025-07-08T10:07:01.889+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-07-08T10:07:01.902+0000] {taskinstance.py:3482} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-07-08T10:07:01.903+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
